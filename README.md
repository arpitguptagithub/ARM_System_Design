# Compiler for a Custom Language and TAC-to-VM Conversion

## Overview

This repository contains two essential components:

1. **`prob1.y`**: A YACC file that defines a custom programming language's grammar, syntax, and semantic rules. It generates a Three-Address Code (TAC) as the intermediate representation.
2. **`TAC-VM3.cpp`**: A C++ program that translates TAC into Virtual Machine (VM) instructions.

The compiler and converter form a pipeline for transforming high-level code into VM-executable instructions. Below is a detailed breakdown of each file and its usage.

---

## File Details

### `prob1.y`

#### Purpose
This YACC file implements the compiler front end for a custom programming language. It parses the language syntax, validates semantics, and generates TAC.

#### Key Features
The file supports the following features:

1. **Arithmetic Operations**:
   - Operators: `+`, `-`, `*`, `/`
   - Handles precedence and associativity.

2. **Logical and Relational Operations**:
   - Relational operators: `>`, `<`, `>=`, `<=`, `==`, `!=`
   - Logical operators: `&&`, `||`, `!`

3. **Variable Declarations and Assignments**:
   - Supports scalar variables and array declarations.
   - Example:
     ```c
     int a;
     int arr[10];
     a = 5;
     arr[2] = 15;
     ```

4. **Control Flow Statements**:
   - **Conditionals**:
     - `if` and `if-else` constructs with support for nested statements.
   - **Loops**:
     - `while` and `for` loops for iterative tasks.

5. **Function Definitions and Calls**:
   - Allows user-defined functions with parameters and return types.
   - Example:
     ```c
     int add(int a, int b) {
         return a + b;
     }
     ```
   - Generates appropriate TAC for function calls and returns.

6. **Input and Output**:
   - **Input**: Read values using `SCAN` statements.
     ```c
     SCAN(a);
     ```
   - **Output**: Print values using `PRINT` statements.
     ```c
     PRINT(a);
     ```

7. **Array Indexing and Operations**:
   - Arrays are supported with bounds-checking logic.
   - Allows operations on array elements:
     ```c
     arr[i] = arr[j] + 1;
     ```

8. **Error Handling**:
   - Reports syntax errors with detailed messages for debugging.

#### Output
- **TAC Generation**: For every language construct, TAC is generated.
  - Example for `a = b + c;`:
    ```tac
    t1 = b + c
    a = t1
    ```

---

### `TAC-VM3.cpp`

#### Purpose
This C++ program translates the TAC generated by `prob1.y` into a sequence of VM instructions suitable for execution on a virtual machine.

#### Key Features
- **Operator Translation**:
  - Maps arithmetic, logical, and relational operations to VM instructions.
  - Example: `+` becomes `addi`.

- **Type and Memory Management**:
  - Handles variables, constants, and temporary registers efficiently.
  - Supports array indexing and function arguments.

- **Control Flow Handling**:
  - Converts labels, conditionals, loops, and function calls into VM instructions.

#### Output
- **VM Instructions**: Generates VM-compatible code, such as:
  ```vm
  push local 0
  push constant 1
  Addi
  pop local 1
  ```

---

## How to Use

### Prerequisites
- A C compiler (e.g., GCC) for compiling the parser and TAC-to-VM converter.
- YACC and Lex for generating the parser from `prob1.y`.

### Steps
1. **Compile `prob1.y`**:
   ```bash
   yacc -d prob1.y
   cc -o parser y.tab.c -ll
   ```
2. **Parse Source Code**:
   ```bash
   ./parser < source_code.txt > tac.txt
   ```
3. **Convert TAC to VM Instructions**:
   - Compile the converter:
     ```bash
     g++ TAC-VM3.cpp -o tac_to_vm
     ```
   - Run the converter:
     ```bash
     ./tac_to_vm > vm_instructions.txt
     ```

---

## Example Workflow

1. Write the source code (`example_source.txt`) in the custom language:
   ```c
   int a, b, sum;
   a = 5;
   b = 10;
   sum = a + b;
   PRINT(sum);
   ```

2. Generate TAC:
   ```bash
   ./parser < example_source.txt > tac.txt
   ```
   **Example TAC Output**:
   ```tac
   t1 = 5
   a = t1
   t2 = 10
   b = t2
   t3 = a + b
   sum = t3
   PRINT sum
   ```

3. Convert TAC to VM Instructions:
   ```bash
   ./tac_to_vm > vm_instructions.txt
   ```
   **Example VM Output**:
   ```vm
   push constant 5
   pop local 0
   push constant 10
   pop local 1
   push local 0
   push local 1
   addi
   pop local 2
   push local 2
   print INT
   ```

